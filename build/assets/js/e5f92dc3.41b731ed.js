"use strict";(globalThis.webpackChunkmydocs=globalThis.webpackChunkmydocs||[]).push([[2962],{2573:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>m,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"Foundations/system-architecture","title":"System Architecture","description":"Purpose","source":"@site/docs/Foundations/system-architecture.md","sourceDirName":"Foundations","slug":"/Foundations/system-architecture","permalink":"/brs-rmm-ai-documentation/docs/Foundations/system-architecture","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Foundations/system-architecture.md","tags":[{"inline":true,"label":"architecture","permalink":"/brs-rmm-ai-documentation/docs/tags/architecture"},{"inline":true,"label":"system-design","permalink":"/brs-rmm-ai-documentation/docs/tags/system-design"},{"inline":true,"label":"components","permalink":"/brs-rmm-ai-documentation/docs/tags/components"},{"inline":true,"label":"infrastructure","permalink":"/brs-rmm-ai-documentation/docs/tags/infrastructure"},{"inline":true,"label":"deployment","permalink":"/brs-rmm-ai-documentation/docs/tags/deployment"}],"version":"current","lastUpdatedBy":"Hair","lastUpdatedAt":1761835238000,"frontMatter":{"status":"draft","lastReviewed":"2025-10-08T00:00:00.000Z","owner":"members-module-team","category":"foundations","tags":["architecture","system-design","components","infrastructure","deployment"]},"sidebar":"foundationsSidebar","previous":{"title":"Security Overview","permalink":"/brs-rmm-ai-documentation/docs/Foundations/security-overview"}}');var t=s(4848),r=s(8453);const l={status:"draft",lastReviewed:new Date("2025-10-08T00:00:00.000Z"),owner:"members-module-team",category:"foundations",tags:["architecture","system-design","components","infrastructure","deployment"]},o="System Architecture",a={},c=[{value:"Purpose",id:"purpose",level:2},{value:"When You Need This",id:"when-you-need-this",level:2},{value:"Context / Diagram",id:"context--diagram",level:2},{value:"Key Concepts",id:"key-concepts",level:2},{value:"Flow / Sequence",id:"flow--sequence",level:2},{value:"Rules &amp; Constraints",id:"rules--constraints",level:2},{value:"Minimal Example",id:"minimal-example",level:2},{value:"Common Pitfalls",id:"common-pitfalls",level:2},{value:"See Also",id:"see-also",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"system-architecture",children:"System Architecture"})}),"\n",(0,t.jsx)(n.h2,{id:"purpose",children:"Purpose"}),"\n",(0,t.jsx)(n.p,{children:"Provide a high-level mental model of how the Members Module processes a request using an API\u2011first, command-driven design with strict club scoping and no local persistence layer."}),"\n",(0,t.jsx)(n.h2,{id:"when-you-need-this",children:"When You Need This"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Orienting as a new engineer"}),"\n",(0,t.jsx)(n.li,{children:"Assessing impact of a feature change"}),"\n",(0,t.jsx)(n.li,{children:"Locating the correct abstraction (Command vs Service vs Repository)"}),"\n",(0,t.jsx)(n.li,{children:"Explaining flow to stakeholders"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"context--diagram",children:"Context / Diagram"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Browser / Client\n  \u2193 HTTP (Symfony Controller)\nController \u2192 Command Bus \u2192 Handler\n                      \u2193\n                Repository (Guzzle)\n                      \u2193\n                   BRS API\n                      \u2193\n                Value Objects\n                      \u2193\n                View Model / Twig\n                      \u2193\n                  Response\n                       \u21ba\n                  Redis Cache\n"})}),"\n",(0,t.jsx)(n.h2,{id:"key-concepts",children:"Key Concepts"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"API-First: All authoritative data originates from external BRS API endpoints"}),"\n",(0,t.jsx)(n.li,{children:"Command Bus: Decouples intent (Command) from execution (Handler)"}),"\n",(0,t.jsx)(n.li,{children:"Repository: Encapsulates outbound HTTP calls + response mapping + caching"}),"\n",(0,t.jsx)(n.li,{children:"Value Object: Immutable domain representation created from API responses"}),"\n",(0,t.jsx)(n.li,{children:"Club Context: Mandatory scoping derived from session; forbids cross-club leakage"}),"\n",(0,t.jsx)(n.li,{children:"Caching: Redis-based, deterministic keys (see Repository & Caching Strategy)"}),"\n",(0,t.jsx)(n.li,{children:"Frontend Bridge: Vue components + jQuery AJAX emit / listen DOM events"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"flow--sequence",children:"Flow / Sequence"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Request enters via Symfony routing and lightweight Controller"}),"\n",(0,t.jsx)(n.li,{children:"Controller extracts club context (session) and request parameters"}),"\n",(0,t.jsx)(n.li,{children:"Controller instantiates and dispatches a Command to the command bus"}),"\n",(0,t.jsx)(n.li,{children:"Handler validates prerequisites (club scope, required fields)"}),"\n",(0,t.jsx)(n.li,{children:"Handler coordinates one or more Repositories (read/write via external API)"}),"\n",(0,t.jsx)(n.li,{children:"Repositories check Redis cache (hit \u2192 hydrate Value Objects; miss \u2192 HTTP call)"}),"\n",(0,t.jsx)(n.li,{children:"Handler composes Value Objects into a View Model or returns domain result"}),"\n",(0,t.jsx)(n.li,{children:"Controller renders Twig or JSON; frontend (if applicable) hydrates Vue state"}),"\n",(0,t.jsx)(n.li,{children:"DOM events propagate updates to other components"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"rules--constraints",children:"Rules & Constraints"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Club Context MUST be resolved before any repository call"}),"\n",(0,t.jsx)(n.li,{children:"Handlers MUST NOT embed HTTP logic; only coordinate repositories & services"}),"\n",(0,t.jsx)(n.li,{children:"Repositories MUST return Value Objects or simple primitives, never raw arrays"}),"\n",(0,t.jsx)(n.li,{children:"Commands SHOULD remain thin: only intent + scalar/value object properties"}),"\n",(0,t.jsx)(n.li,{children:"Controllers MUST stay passive: no business branching beyond dispatch & mapping"}),"\n",(0,t.jsx)(n.li,{children:"Redis keys MUST follow canonical schema (refer to caching strategy doc)"}),"\n",(0,t.jsx)(n.li,{children:"Value Objects MUST be immutable after construction"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"minimal-example",children:"Minimal Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"// Controller snippet (simplified)\n$command = new UpdateMemberContactCommand($clubId, $memberId, $newEmail);\n$result  = $commandBus->handle($command);\n\n// Handler (conceptual)\npublic function handle(UpdateMemberContactCommand $c): MemberContactVO {\n    $profile = $this->memberRepository->fetchProfile($c->clubId(), $c->memberId());\n    $updated = $this->memberRepository->updateEmail($c->clubId(), $c->memberId(), $c->email());\n    return MemberContactVO::from($updated);\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"common-pitfalls",children:"Common Pitfalls"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Skipping club context validation inside handlers"}),"\n",(0,t.jsx)(n.li,{children:"Embedding HTTP client calls directly in handlers or services"}),"\n",(0,t.jsx)(n.li,{children:"Returning associative arrays instead of Value Objects"}),"\n",(0,t.jsx)(n.li,{children:"Recomputing cache keys inconsistently across repositories"}),"\n",(0,t.jsx)(n.li,{children:"Bloated Controllers performing orchestration logic"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"../foundations/request-lifecycle.md",children:"Request Lifecycle"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"../patterns/commands-and-handlers.md",children:"Commands & Handlers"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"../patterns/repository-and-caching-strategy.md",children:"Repository & Caching Strategy"})}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>o});var i=s(6540);const t={},r=i.createContext(t);function l(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);